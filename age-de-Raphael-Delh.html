<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Durée depuis le 8 Mars 2006 à 09:02</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background-color: #f0f0f0;
        }
        .container {
            text-align: center;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            max-width: 600px;
        }
        select, button {
            margin-top: 10px;
            padding: 10px;
            font-size: 16px;
        }
        .duration {
            font-size: 24px;
            margin-top: 20px;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>Durée depuis le 8 Mars 2006 à 09:02</h1>
    <select id="durationSelect">
        <option value="full">Âge global</option>
        <option value="years">Années</option>
        <option value="months">Mois totaux</option>
        <option value="days">Jours totaux</option>
        <option value="hours">Heures totales</option>
        <option value="minutes">Minutes totales</option>
        <option value="seconds">Secondes totales</option>
        <option value="weeks">Semaines totales</option>
        <option value="milliseconds">Millisecondes totales</option>
    </select>
    <div id="duration" class="duration"></div>
</div>

<script>
    async function fetchCurrentTime() {
        try {
            const response = await fetch('https://worldtimeapi.org/api/ip');
            if (!response.ok) {
                throw new Error('Erreur de connexion au serveur');
            }
            const data = await response.json();
            return new Date(data.datetime); // Convertir en objet Date
        } catch (error) {
            console.error('Erreur lors de la récupération de l\'heure du serveur:', error);
            return new Date(); // En cas d'erreur, retourne la date locale
        }
    }

    function formatNumber(number) {
        return number.toLocaleString('fr-FR');
    }

    function calculateDuration(startDate, currentDate) {
        const totalMilliseconds = currentDate - startDate;
        const totalSeconds = Math.floor(totalMilliseconds / 1000);
        const totalMinutes = Math.floor(totalSeconds / 60);
        const totalHours = Math.floor(totalMinutes / 60);
        const totalDays = Math.floor(totalHours / 24);
        const totalWeeks = Math.floor(totalDays / 7);
        const totalMonths = Math.floor(totalDays / 30.44); // Environ 30.44 jours par mois
        const totalYears = Math.floor(totalMonths / 12);

        let years = totalYears;
        let months = totalMonths % 12;
        let days = Math.floor(totalDays % 30.44);
        let hours = totalHours % 24;
        let minutes = totalMinutes % 60;
        let seconds = totalSeconds % 60;
        let milliseconds = totalMilliseconds % 1000;

        return {
            years,
            months,
            days,
            hours,
            minutes,
            seconds,
            milliseconds,
            totalYears,
            totalMonths,
            totalDays,
            totalWeeks,
            totalHours,
            totalMinutes,
            totalSeconds,
            totalMilliseconds
        };
    }

    function formatDuration(duration, unit) {
        switch (unit) {
            case 'years':
                return `${formatNumber(duration.totalYears)} années`;
            case 'months':
                return `${formatNumber(duration.totalMonths)} mois totaux`;
            case 'days':
                return `${formatNumber(duration.totalDays)} jours totaux`;
            case 'hours':
                return `${formatNumber(duration.totalHours)} heures totales`;
            case 'minutes':
                return `${formatNumber(duration.totalMinutes)} minutes totales`;
            case 'seconds':
                return `${formatNumber(duration.totalSeconds)} secondes totales`;
            case 'weeks':
                return `${formatNumber(duration.totalWeeks)} semaines totales`;
            case 'milliseconds':
                return `${formatNumber(duration.totalMilliseconds)} millisecondes totales`;
            case 'full':
                return `${formatNumber(duration.years)} années, ${formatNumber(duration.months)} mois, ${formatNumber(duration.days)} jours, ${formatNumber(duration.hours)} heures, ${formatNumber(duration.minutes)} minutes, ${formatNumber(duration.seconds)} secondes`;
            default:
                return `${formatNumber(duration.years)} années`;
        }
    }

    async function updateDuration() {
        const durationElement = document.getElementById('duration');
        const startDate = new Date('2006-03-08T09:02:00Z'); // Date de début avec heure spécifique
        const currentDate = await fetchCurrentTime();
        
        const duration = calculateDuration(startDate, currentDate);
        const selectElement = document.getElementById('durationSelect');
        const selectedOption = selectElement.value;
        const durationString = formatDuration(duration, selectedOption);
        
        durationElement.textContent = durationString;
    }

    // Mettre à jour la durée immédiatement
    updateDuration();
    // Mettre à jour la durée chaque seconde
    setInterval(updateDuration, 1000);
    
    // Écouter les changements dans le menu déroulant
    document.getElementById('durationSelect').addEventListener('change', updateDuration);
</script>

</body>
</html>